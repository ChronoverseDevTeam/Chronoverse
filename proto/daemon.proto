syntax = "proto3";
package daemon_proto;

message BonjourReq {
}

message BonjourRsp {
  string daemonVersion = 1;
  int32 apiLevel = 2;
  string platform = 3;
  string os = 4;
  string architecture = 5;
}

// Workspace management
message CreateWorkspaceReq {
}

message CreateWorkspaceRsp {
  bool success = 1;
  string message = 2;
  string workspace_path = 3;
}

message DeleteWorkspaceReq {
  string workspace_name = 1;
}

message DeleteWorkspaceRsp {
  bool success = 1;
  string message = 2;
}

message ListWorkspacesReq {
}

message ListWorkspacesRsp {
  bool success = 1;
  string message = 2;
  repeated string workspace_names = 3;
}

message DescribeWorkspaceReq {
  string workspace_name = 1;
}

message DescribeWorkspaceRsp {
  bool success = 1;
  string message = 2;
  string workspace_name = 3;
  string workspace_path = 4;
  repeated string file_paths = 5;
}

// File operations
message AddReq {
  repeated string paths = 1;
}

message AddRsp {
  bool success = 1;
  string message = 2;
  repeated string added_paths = 3;
}

message SyncReq {
  repeated string depot_paths = 1;
  bool force = 2;
}

message SyncRsp {
  bool success = 1;
  string message = 2;
  repeated string synced_paths = 3;
}

message LockReq {
  repeated string paths = 1;
}

message LockRsp {
  bool success = 1;
  string message = 2;
  repeated string locked_paths = 3;
}

message RevertReq {
  repeated string paths = 1;
}

message RevertRsp {
  bool success = 1;
  string message = 2;
  repeated string reverted_paths = 3;
}

message SubmitReq {
  repeated string paths = 1;
}

message SubmitRsp {
  bool success = 1;
  string message = 2;
  repeated string submitted_paths = 3;
}

// Changelist management
message CreateChangelistReq {
  string description = 1;
}

message CreateChangelistRsp {
  bool success = 1;
  string message = 2;
  string changelist_id = 3;
}

message DeleteChangelistReq {
  string changelist_id = 1;
}

message DeleteChangelistRsp {
  bool success = 1;
  string message = 2;
}

message ListChangelistsReq {
}

message ListChangelistsRsp {
  bool success = 1;
  string message = 2;
  repeated ChangelistInfo changelists = 3;
}

message ChangelistInfo {
  string id = 1;
  string description = 2;
  int32 file_count = 3;
  string status = 4;
}

message DescribeChangelistReq {
  string changelist_id = 1;
  bool list_files = 2;
}

message DescribeChangelistRsp {
  bool success = 1;
  string message = 2;
  ChangelistInfo changelist = 3;
  repeated string file_paths = 4;
}

message AppendChangelistReq {
  string changelist_id = 1;
  repeated string paths = 2;
}

message AppendChangelistRsp {
  bool success = 1;
  string message = 2;
}

message SubmitChangelistReq {
  string changelist_id = 1;
}

message SubmitChangelistRsp {
  bool success = 1;
  string message = 2;
}

service EdgeDaemonService {
  // Basic operations
  rpc Bonjour(BonjourReq) returns (BonjourRsp);

  // Workspace management
  rpc CreateWorkspace(CreateWorkspaceReq) returns (CreateWorkspaceRsp);
  rpc DeleteWorkspace(DeleteWorkspaceReq) returns (DeleteWorkspaceRsp);
  rpc ListWorkspaces(ListWorkspacesReq) returns (ListWorkspacesRsp);
  rpc DescribeWorkspace(DescribeWorkspaceReq) returns (DescribeWorkspaceRsp);

  // File operations
  rpc Add(AddReq) returns (AddRsp);
  rpc Sync(SyncReq) returns (SyncRsp);
  rpc Lock(LockReq) returns (LockRsp);
  rpc Revert(RevertReq) returns (RevertRsp);
  rpc Submit(SubmitReq) returns (SubmitRsp);

  // Changelist management
  rpc CreateChangelist(CreateChangelistReq) returns (CreateChangelistRsp);
  rpc DeleteChangelist(DeleteChangelistReq) returns (DeleteChangelistRsp);
  rpc ListChangelists(ListChangelistsReq) returns (ListChangelistsRsp);
  rpc DescribeChangelist(DescribeChangelistReq) returns (DescribeChangelistRsp);
  rpc AppendChangelist(AppendChangelistReq) returns (AppendChangelistRsp);
  rpc SubmitChangelist(SubmitChangelistReq) returns (SubmitChangelistRsp);
}
